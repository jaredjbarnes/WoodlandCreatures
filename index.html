<!DOCTYPE html>
<html>
<head>
    <title>Woodand Creatures</title>
    <meta charset="utf-8" />
    <style>
        html, body {
            overflow: hidden;
        }
    </style>
</head>
<body>
    <canvas id="viewport" width="600" height="300"></canvas>
    <script src="lib/weblib/lib/BASE/BASE.js"></script>
    <script>
        BASE.require.loader.setRoot("lib/weblib/lib/BASE/");
        BASE.require.loader.setNamespace("app", "app");
        BASE.require.loader.setNamespace("Matter", "Matter");

        BASE.require([
            "app.Game",
            "app.Entity",
            "app.systems.ImageTextureSystem",
            "app.systems.SpriteSystem",
            "app.systems.ViewportSystem",
            "app.entities.Map",
            "app.entities.Player",
            "app.Timer",
        ], function () {
            var canvas = document.querySelector("#viewport");

            var Timer = app.Timer;
            var Game = app.Game;
            var Camera = app.systems.Camera;
            var Entity = app.Entity;
            var Map = app.entities.Map;
            var SpriteSystem = app.systems.SpriteSystem;
            var ViewportSystem = app.systems.ViewportSystem;
            var ImageTextureSystem = app.systems.ImageTextureSystem;
            var Player = app.entities.Player;

            var imageTextureSystem = new ImageTextureSystem(canvas);
            var viewportSystem = new ViewportSystem();
            var spriteSystem = new SpriteSystem();
            var timer = new Timer();
            var map = new Map();
            var player = new Player();

            viewportSystem.width = canvas.width;
            viewportSystem.height = canvas.height;

            for (var x = 0 ; x < 1000; x += 10) {
                for (var y = 0 ; y < 1000; y += 10) {
                    player = new Player();
                    var transform = player.getPropertyByType(app.properties.Transform);
                    transform.x = x;
                    transform.y = y;
                    map.appendChild(player);
                }
            }

            var game = new Game(map, timer);

            game.appendSystem(imageTextureSystem);
            game.appendSystem(spriteSystem);
            game.appendSystem(viewportSystem);
            game.play();

            window.game = game;
            window.viewportSystem = viewportSystem;
        });
    </script>
</body>
</html>
